<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Đăng ký - SmartCalories</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <style>
    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      33% { transform: translateY(-10px) rotate(1deg); }
      66% { transform: translateY(5px) rotate(-1deg); }
    }
    
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 20px rgba(16, 185, 129, 0.3); }
      50% { box-shadow: 0 0 30px rgba(16, 185, 129, 0.5); }
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes shimmer {
      0% { background-position: -468px 0; }
      100% { background-position: 468px 0; }
    }
    
    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    .animate-float {
      animation: float 6s ease-in-out infinite;
    }
    
    .animate-pulse-glow {
      animation: pulse-glow 2s ease-in-out infinite;
    }
    
    .animate-fade-in-up {
      animation: fadeInUp 0.6s ease-out forwards;
    }
    
    .animate-slide-in-right {
      animation: slideInRight 0.5s ease-out forwards;
    }
    
    .glass-morphism {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .shimmer {
      background: linear-gradient(to right, transparent, rgba(255,255,255,0.4), transparent);
      background-size: 200% 100%;
      animation: shimmer 2s infinite;
    }
    
    .input-glow:focus {
      box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1), 0 0 20px rgba(16, 185, 129, 0.2);
    }
    
    .gradient-text {
      background: linear-gradient(135deg, #059669 0%, #10b981 50%, #34d399 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .floating-shapes::before,
    .floating-shapes::after {
      content: '';
      position: absolute;
      border-radius: 50%;
      background: linear-gradient(45deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1));
      z-index: -1;
    }
    
    .floating-shapes::before {
      width: 200px;
      height: 200px;
      top: -100px;
      right: -100px;
      animation: float 8s ease-in-out infinite;
    }
    
    .floating-shapes::after {
      width: 150px;
      height: 150px;
      bottom: -75px;
      left: -75px;
      animation: float 6s ease-in-out infinite reverse;
    }
    
    .password-strength {
      height: 4px;
      border-radius: 2px;
      transition: all 0.3s ease;
    }
    
    .strength-weak { background: #ef4444; }
    .strength-medium { background: #f59e0b; }
    .strength-strong { background: #10b981; }

    /* Mobile optimizations */
    @media (max-width: 640px) {
      .floating-shapes::before,
      .floating-shapes::after {
        display: none;
      }
      
      .animate-float {
        animation: none;
      }
      
      body {
        padding: 0.5rem;
        min-height: 100vh;
        min-height: 100dvh; /* Dynamic viewport height for mobile */
      }
    }
  </style>
</head>
<body class="bg-gradient-to-br from-emerald-500 via-green-500 to-teal-600 min-h-screen min-h-[100dvh] flex items-start sm:items-center justify-center px-2 sm:px-4 py-4 sm:py-0 relative overflow-x-hidden">
  <!-- Background decorative elements -->
  <div class="absolute inset-0 overflow-hidden hidden sm:block">
    <div class="absolute -top-40 -right-40 w-80 h-80 bg-white opacity-10 rounded-full blur-3xl animate-pulse"></div>
    <div class="absolute -bottom-40 -left-40 w-96 h-96 bg-emerald-300 opacity-10 rounded-full blur-3xl animate-pulse delay-1000"></div>
    <div class="absolute top-1/4 left-1/4 w-32 h-32 bg-green-300 opacity-5 rounded-full blur-2xl animate-ping"></div>
    <div class="absolute bottom-1/3 right-1/3 w-24 h-24 bg-teal-300 opacity-5 rounded-full blur-2xl animate-ping delay-700"></div>
  </div>

  <div class="glass-morphism p-4 sm:p-8 md:p-12 rounded-2xl sm:rounded-3xl shadow-2xl max-w-md w-full border border-white/20 transition-all duration-500 hover:shadow-3xl animate-fade-in-up floating-shapes relative my-4 sm:my-0">
    <!-- Header Section -->
    <div class="flex flex-col items-center mb-6 sm:mb-8">
      <div class="relative mb-4 sm:mb-6">
        <div class="bg-gradient-to-br from-emerald-400 to-green-500 rounded-full p-4 sm:p-6 shadow-lg animate-float animate-pulse-glow">
          <i class="fa fa-user-plus text-3xl sm:text-5xl text-white"></i>
        </div>
        <div class="absolute -top-1 -right-1 sm:-top-2 sm:-right-2 w-4 h-4 sm:w-6 sm:h-6 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full animate-ping"></div>
      </div>
      
      <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-center mb-2 sm:mb-3 gradient-text tracking-wide">
        Đăng ký
      </h2>
      
      <div class="w-12 sm:w-16 h-1 bg-gradient-to-r from-emerald-500 to-green-500 rounded-full mb-3 sm:mb-4"></div>
      
      <p class="text-gray-600 text-center text-sm md:text-base leading-relaxed px-2">
        Tạo tài khoản mới để bắt đầu hành trình 
        <span class="font-semibold text-emerald-600">sức khỏe</span> và 
        <span class="font-semibold text-green-600">dinh dưỡng</span> của bạn!
      </p>
    </div>

    <!-- Form Section -->
    <form method="post" action="/register" class="space-y-4 sm:space-y-5">
      <div class="relative group">
        <div class="absolute inset-0 bg-gradient-to-r from-emerald-500 to-green-500 rounded-xl opacity-0 group-hover:opacity-10 transition-opacity blur"></div>
        <input 
          type="text" 
          name="fullname" 
          placeholder="Họ và tên" 
          required
          class="peer w-full py-3 sm:py-4 pl-12 sm:pl-14 pr-4 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:border-transparent transition-all duration-300 shadow-sm bg-white/80 backdrop-blur-sm input-glow text-gray-700 placeholder-gray-400 text-sm sm:text-base"
        />
        <i class="fa fa-user-circle absolute left-3 sm:left-4 top-3 sm:top-4 text-gray-400 peer-focus:text-emerald-500 transition-colors duration-300 text-base sm:text-lg"></i>
        <div class="absolute inset-x-0 bottom-0 h-0.5 bg-gradient-to-r from-emerald-500 to-green-500 scale-x-0 peer-focus:scale-x-100 transition-transform duration-300 rounded-full"></div>
      </div>
      
      <div class="relative group">
        <div class="absolute inset-0 bg-gradient-to-r from-emerald-500 to-green-500 rounded-xl opacity-0 group-hover:opacity-10 transition-opacity blur"></div>
        <input 
          type="text" 
          name="username" 
          placeholder="Tên đăng nhập" 
          required
          class="peer w-full py-3 sm:py-4 pl-12 sm:pl-14 pr-4 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:border-transparent transition-all duration-300 shadow-sm bg-white/80 backdrop-blur-sm input-glow text-gray-700 placeholder-gray-400 text-sm sm:text-base"
        />
        <i class="fa fa-user absolute left-3 sm:left-4 top-3 sm:top-4 text-gray-400 peer-focus:text-emerald-500 transition-colors duration-300 text-base sm:text-lg"></i>
        <div class="absolute inset-x-0 bottom-0 h-0.5 bg-gradient-to-r from-emerald-500 to-green-500 scale-x-0 peer-focus:scale-x-100 transition-transform duration-300 rounded-full"></div>
      </div>
      
      <div class="relative group">
        <div class="absolute inset-0 bg-gradient-to-r from-emerald-500 to-green-500 rounded-xl opacity-0 group-hover:opacity-10 transition-opacity blur"></div>
        <input 
          type="email" 
          name="email" 
          placeholder="Email" 
          required
          class="peer w-full py-3 sm:py-4 pl-12 sm:pl-14 pr-4 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:border-transparent transition-all duration-300 shadow-sm bg-white/80 backdrop-blur-sm input-glow text-gray-700 placeholder-gray-400 text-sm sm:text-base"
        />
        <i class="fa fa-envelope absolute left-3 sm:left-4 top-3 sm:top-4 text-gray-400 peer-focus:text-emerald-500 transition-colors duration-300 text-base sm:text-lg"></i>
        <div class="absolute inset-x-0 bottom-0 h-0.5 bg-gradient-to-r from-emerald-500 to-green-500 scale-x-0 peer-focus:scale-x-100 transition-transform duration-300 rounded-full"></div>
      </div>
      
      <div class="relative group">
        <div class="absolute inset-0 bg-gradient-to-r from-emerald-500 to-green-500 rounded-xl opacity-0 group-hover:opacity-10 transition-opacity blur"></div>
        <input 
          type="password" 
          name="password" 
          id="password"
          placeholder="Mật khẩu" 
          required
          class="peer w-full py-3 sm:py-4 pl-12 sm:pl-14 pr-10 sm:pr-12 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:border-transparent transition-all duration-300 shadow-sm bg-white/80 backdrop-blur-sm input-glow text-gray-700 placeholder-gray-400 text-sm sm:text-base"
        />
        <i class="fa fa-lock absolute left-3 sm:left-4 top-3 sm:top-4 text-gray-400 peer-focus:text-emerald-500 transition-colors duration-300 text-base sm:text-lg"></i>
        <button type="button" onclick="togglePassword('password', 'toggleIcon1')" class="absolute right-3 sm:right-4 top-3 sm:top-4 text-gray-400 hover:text-emerald-500 transition-colors duration-300">
          <i class="fa fa-eye text-sm sm:text-base" id="toggleIcon1"></i>
        </button>
        <div class="absolute inset-x-0 bottom-0 h-0.5 bg-gradient-to-r from-emerald-500 to-green-500 scale-x-0 peer-focus:scale-x-100 transition-transform duration-300 rounded-full"></div>
        <!-- Password strength indicator -->
        <div class="mt-2">
          <div class="password-strength w-full" id="passwordStrength"></div>
          <p class="text-xs text-gray-500 mt-1" id="passwordHint">Ít nhất 8 ký tự, bao gồm chữ hoa, chữ thường và số</p>
        </div>
      </div>
      
      <div class="relative group">
        <div class="absolute inset-0 bg-gradient-to-r from-emerald-500 to-green-500 rounded-xl opacity-0 group-hover:opacity-10 transition-opacity blur"></div>
        <input 
          type="password" 
          name="confirm_password" 
          id="confirmPassword"
          placeholder="Xác nhận mật khẩu" 
          required
          class="peer w-full py-3 sm:py-4 pl-12 sm:pl-14 pr-10 sm:pr-12 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:border-transparent transition-all duration-300 shadow-sm bg-white/80 backdrop-blur-sm input-glow text-gray-700 placeholder-gray-400 text-sm sm:text-base"
        />
        <i class="fa fa-lock absolute left-3 sm:left-4 top-3 sm:top-4 text-gray-400 peer-focus:text-emerald-500 transition-colors duration-300 text-base sm:text-lg"></i>
        <button type="button" onclick="togglePassword('confirmPassword', 'toggleIcon2')" class="absolute right-3 sm:right-4 top-3 sm:top-4 text-gray-400 hover:text-emerald-500 transition-colors duration-300">
          <i class="fa fa-eye text-sm sm:text-base" id="toggleIcon2"></i>
        </button>
        <div class="absolute inset-x-0 bottom-0 h-0.5 bg-gradient-to-r from-emerald-500 to-green-500 scale-x-0 peer-focus:scale-x-100 transition-transform duration-300 rounded-full"></div>
      </div>
      
      <button 
        type="submit"
        class="group relative w-full bg-gradient-to-r from-emerald-500 via-green-500 to-emerald-600 hover:from-emerald-600 hover:via-green-600 hover:to-emerald-700 text-white py-3 sm:py-4 rounded-xl font-semibold transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-[1.02] transform active:scale-[0.98] overflow-hidden text-sm sm:text-base"
      >
        <span class="relative z-10 flex items-center justify-center gap-2">
          <i class="fa fa-user-plus text-base sm:text-lg"></i>
          Tạo tài khoản
        </span>
        <div class="absolute inset-0 shimmer opacity-0 group-hover:opacity-100 transition-opacity"></div>
      </button>
    </form>

    <!-- Message Section -->
    {% if error %}
    <div class="flex items-start gap-3 mt-4 sm:mt-6 bg-gradient-to-r from-red-50 to-pink-50 border border-red-200 text-red-800 px-3 sm:px-4 py-3 sm:py-4 rounded-xl shadow-sm animate-slide-in-right backdrop-blur-sm">
      <div class="bg-red-100 rounded-full p-2 flex-shrink-0 mt-0.5">
        <i class="fa fa-exclamation-triangle text-sm sm:text-lg text-red-600"></i>
      </div>
      <div>
        <p class="font-semibold text-xs sm:text-sm mb-1">Đăng ký thất bại!</p>
        <p class="text-xs sm:text-sm leading-relaxed">{{ error }}</p>
      </div>
    </div>
    {% endif %}

    <!-- Footer Section -->
    <div class="mt-6 sm:mt-8 text-center space-y-3 sm:space-y-4">
      <div class="w-full h-px bg-gradient-to-r from-transparent via-gray-300 to-transparent"></div>
      
      <p class="text-gray-600 text-xs sm:text-sm">
        Đã có tài khoản?
        <a href="/login" class="group text-emerald-600 font-semibold hover:text-emerald-700 transition-colors duration-300 ml-1">
          Đăng nhập ngay
          <i class="fa fa-arrow-right ml-1 group-hover:translate-x-1 transition-transform duration-300 text-xs"></i>
        </a>
      </p>
      
      <!-- Terms and Privacy -->
      <div class="mt-4 sm:mt-6 p-3 sm:p-4 bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl border border-gray-200">
        <p class="text-xs text-gray-600 text-center leading-relaxed">
          Bằng việc đăng ký, bạn đồng ý với 
          <a href="#" class="text-emerald-600 hover:text-emerald-700 font-medium">Điều khoản sử dụng</a> 
          và 
          <a href="#" class="text-emerald-600 hover:text-emerald-700 font-medium">Chính sách bảo mật</a> 
          của chúng tôi.
        </p>
      </div>
    </div>
  </div>

  <script>
    // Toggle password visibility
    function togglePassword(inputId, iconId) {
      const passwordInput = document.getElementById(inputId);
      const toggleIcon = document.getElementById(iconId);
      
      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        toggleIcon.classList.remove('fa-eye');
        toggleIcon.classList.add('fa-eye-slash');
      } else {
        passwordInput.type = 'password';
        toggleIcon.classList.remove('fa-eye-slash');
        toggleIcon.classList.add('fa-eye');
      }
    }

    // Password strength checker
    document.getElementById('password').addEventListener('input', function(e) {
      const password = e.target.value;
      const strengthBar = document.getElementById('passwordStrength');
      const hint = document.getElementById('passwordHint');
      
      let strength = 0;
      let message = '';
      
      if (password.length >= 8) strength++;
      if (/[a-z]/.test(password)) strength++;
      if (/[A-Z]/.test(password)) strength++;
      if (/[0-9]/.test(password)) strength++;
      if (/[^A-Za-z0-9]/.test(password)) strength++;
      
      switch (strength) {
        case 0:
        case 1:
          strengthBar.className = 'password-strength w-1/4 strength-weak';
          message = 'Mật khẩu yếu - Cần cải thiện';
          break;
        case 2:
        case 3:
          strengthBar.className = 'password-strength w-2/4 strength-medium';
          message = 'Mật khẩu trung bình - Khá tốt';
          break;
        case 4:
        case 5:
          strengthBar.className = 'password-strength w-full strength-strong';
          message = 'Mật khẩu mạnh - Tuyệt vời!';
          break;
        default:
          strengthBar.className = 'password-strength w-0';
          message = 'Ít nhất 8 ký tự, bao gồm chữ hoa, chữ thường và số';
      }
      
      hint.textContent = message;
    });

    // Confirm password validation
    document.getElementById('confirmPassword').addEventListener('input', function(e) {
      const password = document.getElementById('password').value;
      const confirmPassword = e.target.value;
      
      if (confirmPassword && password !== confirmPassword) {
        e.target.classList.add('border-red-300', 'bg-red-50');
        e.target.classList.remove('border-green-300', 'bg-green-50');
      } else if (confirmPassword && password === confirmPassword) {
        e.target.classList.add('border-green-300', 'bg-green-50');
        e.target.classList.remove('border-red-300', 'bg-red-50');
      } else {
        e.target.classList.remove('border-green-300', 'bg-green-50', 'border-red-300', 'bg-red-50');
      }
    });

    // Form submission with loading state
    document.querySelector('form').addEventListener('submit', function(e) {
      const button = this.querySelector('button[type="submit"]');
      const originalText = button.innerHTML;
      
      button.innerHTML = `
        <span class="flex items-center justify-center gap-2">
          <i class="fa fa-spinner fa-spin"></i>
          Đang tạo tài khoản...
        </span>
      `;
      button.disabled = true;
      
      // Re-enable button after 5 seconds (in case of network issues)
      setTimeout(() => {
        button.innerHTML = originalText;
        button.disabled = false;
      }, 5000);
    });

    // Real-time input validation
    document.querySelectorAll('input').forEach(input => {
      input.addEventListener('input', function(e) {
        const value = e.target.value.trim();
        
        if (e.target.type === 'email') {
          const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          if (value && emailRegex.test(value)) {
            e.target.classList.add('border-green-300', 'bg-green-50');
            e.target.classList.remove('border-red-300', 'bg-red-50');
          } else if (value) {
            e.target.classList.add('border-red-300', 'bg-red-50');
            e.target.classList.remove('border-green-300', 'bg-green-50');
          }
        } else if (e.target.name === 'username') {
          if (value && value.length >= 3 && /^[a-zA-Z0-9_]+$/.test(value)) {
            e.target.classList.add('border-green-300', 'bg-green-50');
            e.target.classList.remove('border-red-300', 'bg-red-50');
          } else if (value) {
            e.target.classList.add('border-red-300', 'bg-red-50');
            e.target.classList.remove('border-green-300', 'bg-green-50');
          }
        } else if (e.target.name === 'fullname') {
          if (value && value.length >= 2) {
            e.target.classList.add('border-green-300', 'bg-green-50');
            e.target.classList.remove('border-red-300', 'bg-red-50');
          } else if (value) {
            e.target.classList.add('border-red-300', 'bg-red-50');
            e.target.classList.remove('border-green-300', 'bg-green-50');
          }
        }
        
        if (!value) {
          e.target.classList.remove('border-green-300', 'bg-green-50', 'border-red-300', 'bg-red-50');
        }
      });
    });
  </script>
</body>
</html>
